"0","#| label: gen_dft_fn"
"0",""
"0","gen_dft_fn <- function("
"0","    dft # <cpl> discrete Fourier transform"
"0",") {"
"0","  n_dft <- length(dft)"
"0","  idx   <- (1:n_dft) - 1L"
"0","  coeff <- dft/n_dft"
"0","  "
"0","  dft_fn <- function(x # <dbl> scalar value"
"0","  ) {"
"0","    return(sum("
"0","      coeff * exp(2 * pi * (0 + 1i) * idx * x / n_dft)"
"0","    ))"
"0","  }"
"0","  return(dft_fn)"
"0","}"
"0",""
